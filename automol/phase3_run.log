2024-09-22 02:08:09,871 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\simulation
2024-09-22 02:08:09,872 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\docking
2024-09-22 02:08:09,872 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\analysis
2024-09-22 02:08:09,893 - __main__ - INFO - Using device for simulation: cuda
2024-09-22 02:08:09,893 - __main__ - INFO - Converting ligand PDB files to PDBQT format...
2024-09-22 02:08:09,962 - __main__ - INFO - Converted C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to C:\Users\wes\AutoMol-v2\automol\results\phase3\docking\ligand_20240917_224337.pdbqt
2024-09-22 02:08:09,964 - __main__ - INFO - Converted C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to C:\Users\wes\AutoMol-v2\automol\results\phase3\docking\ligand_20240918_003202.pdbqt
2024-09-22 02:08:09,964 - __main__ - INFO - Starting Docking Simulation...
2024-09-22 02:08:09,965 - phase3.docking_simulation - INFO - Starting Docking Pipeline...
2024-09-22 02:08:09,965 - phase3.docking_simulation - INFO - Converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to PDBQT format.
2024-09-22 02:08:09,965 - phase3.docking_simulation - ERROR - Error converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to PDBQT: module 'pybel' has no attribute 'readfile'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\docking_simulation.py", line 26, in convert_pdb_to_pdbqt
    mol = pybel.readfile("pdb", input_pdb).__next__()
          ^^^^^^^^^^^^^^
AttributeError: module 'pybel' has no attribute 'readfile'
2024-09-22 02:08:09,965 - phase3.docking_simulation - ERROR - Skipping ligand C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb due to conversion error.
2024-09-22 02:08:09,965 - phase3.docking_simulation - INFO - Converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to PDBQT format.
2024-09-22 02:08:09,965 - phase3.docking_simulation - ERROR - Error converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to PDBQT: module 'pybel' has no attribute 'readfile'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\docking_simulation.py", line 26, in convert_pdb_to_pdbqt
    mol = pybel.readfile("pdb", input_pdb).__next__()
          ^^^^^^^^^^^^^^
AttributeError: module 'pybel' has no attribute 'readfile'
2024-09-22 02:08:09,965 - phase3.docking_simulation - ERROR - Skipping ligand C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb due to conversion error.
2024-09-22 02:08:09,966 - phase3.docking_simulation - ERROR - No ligand PDBQT files available for docking.
2024-09-22 02:08:09,966 - __main__ - INFO - Docking Simulation completed.
2024-09-22 02:08:09,966 - __main__ - INFO - Starting Molecular Dynamics Simulation...
2024-09-22 02:08:09,966 - phase3.simulate - INFO - Running simulations on device: cuda
2024-09-22 02:08:13,800 - __main__ - ERROR - Error in Phase 3: name 'simulation_dir' is not defined
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\multiprocessing\pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\multiprocessing\pool.py", line 48, in mapstar
    return list(map(*args))
           ^^^^^^^^^^^^^^^^
  File "C:\Users\wes\AutoMol-v2\automol\phase3\simulate.py", line 111, in simulate
    protein_sim_dir = os.path.join(simulation_dir, f"protein_{protein_id}")
                                   ^^^^^^^^^^^^^^
NameError: name 'simulation_dir' is not defined
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\phase3_run.py", line 106, in run_Phase_3
    simulation_results = run_simulation_pipeline(protein_results, simulation_dir, device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\wes\AutoMol-v2\automol\phase3\simulate.py", line 102, in run_simulation_pipeline
    simulation_results = pool.map(simulate, protein_results)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\multiprocessing\pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\multiprocessing\pool.py", line 774, in get
    raise self._value
NameError: name 'simulation_dir' is not defined
2024-09-22 02:08:13,855 - __main__ - INFO - Phase 3 run completed. Resources cleaned up.
2024-09-22 02:09:32,556 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\simulation
2024-09-22 02:09:32,556 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\docking
2024-09-22 02:09:32,556 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\analysis
2024-09-22 02:09:32,580 - __main__ - INFO - Using device for simulation: cuda
2024-09-22 02:09:32,580 - __main__ - INFO - Converting ligand PDB files to PDBQT format...
2024-09-22 02:09:32,596 - __main__ - INFO - Converted C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to C:\Users\wes\AutoMol-v2\automol\results\phase3\docking\ligand_20240917_224337.pdbqt
2024-09-22 02:09:32,599 - __main__ - INFO - Converted C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to C:\Users\wes\AutoMol-v2\automol\results\phase3\docking\ligand_20240918_003202.pdbqt
2024-09-22 02:09:32,599 - __main__ - INFO - Starting Docking Simulation...
2024-09-22 02:09:32,599 - phase3.docking_simulation - INFO - Starting Docking Pipeline...
2024-09-22 02:09:32,599 - phase3.docking_simulation - INFO - Converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to PDBQT format.
2024-09-22 02:09:32,599 - phase3.docking_simulation - ERROR - Error converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to PDBQT: module 'pybel' has no attribute 'readfile'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\docking_simulation.py", line 26, in convert_pdb_to_pdbqt
    mol = pybel.readfile("pdb", input_pdb).__next__()
          ^^^^^^^^^^^^^^
AttributeError: module 'pybel' has no attribute 'readfile'
2024-09-22 02:09:32,600 - phase3.docking_simulation - ERROR - Skipping ligand C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb due to conversion error.
2024-09-22 02:09:32,600 - phase3.docking_simulation - INFO - Converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to PDBQT format.
2024-09-22 02:09:32,600 - phase3.docking_simulation - ERROR - Error converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to PDBQT: module 'pybel' has no attribute 'readfile'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\docking_simulation.py", line 26, in convert_pdb_to_pdbqt
    mol = pybel.readfile("pdb", input_pdb).__next__()
          ^^^^^^^^^^^^^^
AttributeError: module 'pybel' has no attribute 'readfile'
2024-09-22 02:09:32,600 - phase3.docking_simulation - ERROR - Skipping ligand C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb due to conversion error.
2024-09-22 02:09:32,600 - phase3.docking_simulation - ERROR - No ligand PDBQT files available for docking.
2024-09-22 02:09:32,600 - __main__ - INFO - Docking Simulation completed.
2024-09-22 02:09:32,600 - __main__ - INFO - Starting Molecular Dynamics Simulation...
2024-09-22 02:09:32,600 - phase3.simulate - INFO - Running simulations on device: cuda
2024-09-22 02:09:36,318 - phase3.simulate - INFO - Starting MD simulation for C:\Users\wes\AutoMol-v2\automol\predicted_structures\TNHTMIGING_structure.pdb
2024-09-22 02:09:36,320 - phase3.simulate - INFO - Starting MD simulation for C:\Users\wes\AutoMol-v2\automol\predicted_structures\TYFKGCIIIA_structure.pdb
2024-09-22 02:09:42,309 - phase3.simulate - INFO - Fixed PDB written to C:\Users\wes\AutoMol-v2\results\phase3\results\protein_2\fixed.pdb
2024-09-22 02:09:42,927 - phase3.simulate - INFO - Fixed PDB written to C:\Users\wes\AutoMol-v2\results\phase3\results\protein_1\fixed.pdb
2024-09-22 02:09:44,627 - phase3.simulate - ERROR - Error during MD simulation: unsupported operand type(s) for -: 'type' and 'float'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\simulate.py", line 50, in molecular_dynamics_simulation
    modeller.addSolvent(forcefield, model='tip3p', padding=1.0*nanometer)
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\site-packages\openmm\app\modeller.py", line 587, in addSolvent
    for i in cells.neighbors(atomPos):
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\site-packages\openmm\app\modeller.py", line 1661, in neighbors
    cell = self.cellForPosition(Vec3(pos[0]+i*self.cellSize[0], pos[1]+j*self.cellSize[1], pos[2]+k*self.cellSize[2]))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\site-packages\openmm\app\modeller.py", line 1652, in cellForPosition
    pos -= floor(pos[0]*invBox[0])*self.vectors[0]
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\site-packages\openmm\vec3.py", line 59, in __sub__
    return Vec3(self.x-other[0], self.y-other[1], self.z-other[2])
                ~~~~~~^~~~~~~~~
TypeError: unsupported operand type(s) for -: 'type' and 'float'
2024-09-22 02:10:09,347 - phase3.simulate - INFO - Minimizing energy...
2024-09-22 02:13:30,496 - phase3.simulate - INFO - Equilibrating...
2024-09-22 02:14:00,096 - phase3.simulate - INFO - Starting production run...
2024-09-22 02:16:31,497 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\simulation
2024-09-22 02:16:31,498 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\docking
2024-09-22 02:16:31,498 - __main__ - INFO - Created/Verified directory: C:\Users\wes\AutoMol-v2\automol\results\phase3\analysis
2024-09-22 02:16:31,512 - __main__ - INFO - Using device for simulation: cuda
2024-09-22 02:16:31,512 - __main__ - INFO - Converting ligand PDB files to PDBQT format...
2024-09-22 02:16:31,528 - __main__ - INFO - Converted C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to C:\Users\wes\AutoMol-v2\automol\results\phase3\docking\ligand_20240917_224337.pdbqt
2024-09-22 02:16:31,530 - __main__ - INFO - Converted C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to C:\Users\wes\AutoMol-v2\automol\results\phase3\docking\ligand_20240918_003202.pdbqt
2024-09-22 02:16:31,530 - __main__ - INFO - Starting Docking Simulation...
2024-09-22 02:16:31,530 - phase3.docking_simulation - INFO - Starting Docking Pipeline...
2024-09-22 02:16:31,530 - phase3.docking_simulation - INFO - Converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to PDBQT format.
2024-09-22 02:16:31,530 - phase3.docking_simulation - ERROR - Error converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb to PDBQT: module 'pybel' has no attribute 'readfile'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\docking_simulation.py", line 26, in convert_pdb_to_pdbqt
    mol = pybel.readfile("pdb", input_pdb).__next__()
          ^^^^^^^^^^^^^^
AttributeError: module 'pybel' has no attribute 'readfile'
2024-09-22 02:16:31,531 - phase3.docking_simulation - ERROR - Skipping ligand C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240917_224337.pdb due to conversion error.
2024-09-22 02:16:31,531 - phase3.docking_simulation - INFO - Converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to PDBQT format.
2024-09-22 02:16:31,531 - phase3.docking_simulation - ERROR - Error converting C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb to PDBQT: module 'pybel' has no attribute 'readfile'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\docking_simulation.py", line 26, in convert_pdb_to_pdbqt
    mol = pybel.readfile("pdb", input_pdb).__next__()
          ^^^^^^^^^^^^^^
AttributeError: module 'pybel' has no attribute 'readfile'
2024-09-22 02:16:31,531 - phase3.docking_simulation - ERROR - Skipping ligand C:\Users\wes\AutoMol-v2\results\phase2a\predicted_structures\ligand_20240918_003202.pdb due to conversion error.
2024-09-22 02:16:31,531 - phase3.docking_simulation - ERROR - No ligand PDBQT files available for docking.
2024-09-22 02:16:31,531 - __main__ - INFO - Docking Simulation completed.
2024-09-22 02:16:31,531 - __main__ - INFO - Starting Molecular Dynamics Simulation...
2024-09-22 02:16:31,531 - phase3.simulate - INFO - Running simulations on device: cuda
2024-09-22 02:16:34,860 - phase3.simulate - INFO - Starting MD simulation for C:\Users\wes\AutoMol-v2\automol\predicted_structures\TNHTMIGING_structure.pdb
2024-09-22 02:16:34,871 - phase3.simulate - INFO - Starting MD simulation for C:\Users\wes\AutoMol-v2\automol\predicted_structures\TYFKGCIIIA_structure.pdb
2024-09-22 02:16:39,339 - phase3.simulate - INFO - Fixed PDB written to C:\Users\wes\AutoMol-v2\results\phase3\results\protein_2\fixed.pdb
2024-09-22 02:16:40,154 - phase3.simulate - INFO - Fixed PDB written to C:\Users\wes\AutoMol-v2\results\phase3\results\protein_1\fixed.pdb
2024-09-22 02:17:03,914 - phase3.simulate - ERROR - Error during MD simulation: 'list_iterator' object has no attribute 'atom1'
Traceback (most recent call last):
  File "C:\Users\wes\AutoMol-v2\automol\phase3\simulate.py", line 52, in molecular_dynamics_simulation
    system = forcefield.createSystem(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\site-packages\openmm\app\forcefield.py", line 1410, in createSystem
    force.postprocessSystem(sys, data, args)
  File "C:\Users\wes\Miniconda3\envs\gnn\Lib\site-packages\openmm\app\forcefield.py", line 2125, in postprocessSystem
    atom1 = data.bonds[bond].atom1
            ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list_iterator' object has no attribute 'atom1'
