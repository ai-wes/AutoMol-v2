PlatformÂ¶ class PlatformÂ¶ A Platform defines an implementation of all the kernels needed to perform some calculation. More precisely, a Platform object acts as a registry for a set of KernelFactory objects which together implement the kernels. The Platform class, in turn, provides a static registry of all available Platform objects. To get a Platform object, call Platform& platform = Platform::findPlatform(kernelNames); passing in the names of all kernels that will be required for the calculation you plan to perform. It will return the fastest available Platform which provides implementations of all the specified kernels. You can then call createKernel() to construct particular kernels as needed. Public Functions virtual const std::string &getName() const = 0Â¶ Get the name of this platform. This should be a unique identifier which can be used to recognized it. virtual double getSpeed() const = 0Â¶ Get an estimate of how fast this Platform class is. This need not be precise. It only is expected to return an order or magnitude estimate of the relative performance of different Platform classes. An unoptimized reference implementation should return 1.0, and all other Platforms should return a larger value that is an estimate of how many times faster they are than the reference implementation. virtual bool supportsDoublePrecision() const = 0Â¶ Get whether this Platform supports double precision arithmetic. If this returns false, the platform is permitted to represent double precision values internally as single precision. Deprecated: This method is not well defined, and is too simplistic to describe the actual behavior of some Platforms, such as ones that offer multiple precision modes. It will be removed in a future release. const std::vector<std::string> &getPropertyNames() constÂ¶ Get the names of all Platform-specific properties this Platform supports. virtual const std::string &getPropertyValue(const Context &context, const std::string &property) constÂ¶ Get the value of a Platform-specific property for a Context. Parameters context â the Context for which to get the property property â the name of the property to get Returns the value of the property virtual void setPropertyValue(Context &context, const std::string &property, const std::string &value) constÂ¶ Set the value of a Platform-specific property for a Context. Parameters context â the Context for which to set the property property â the name of the property to set value â the value to set for the property const std::string &getPropertyDefaultValue(const std::string &property) constÂ¶ Get the default value of a Platform-specific property. This is the value that will be used for newly created Contexts. Parameters property â the name of the property to get Returns the default value of the property void setPropertyDefaultValue(const std::string &property, const std::string &value)Â¶ Set the default value of a Platform-specific property. This is the value that will be used for newly created Contexts. Parameters property â the name of the property to set value â the value to set for the property virtual void contextCreated(ContextImpl &context, const std::map<std::string, std::string> &properties) constÂ¶ This is called whenever a new Context is created. It gives the Platform a chance to initialize the context and store platform-specific data in it. Parameters context â the newly created context properties â a set of values for platform-specific properties. Keys are the property names. virtual void linkedContextCreated(ContextImpl &context, ContextImpl &originalContext) constÂ¶ This is called whenever a new Context is created using ContextImpl::createLinkedContext(). It gives the Platform a chance to initialize the context and store platform-specific data in it. Parameters context â the newly created context originalContext â the original context it is linked to virtual void contextDestroyed(ContextImpl &context) constÂ¶ This is called whenever a Context is deleted. It gives the Platform a chance to clean up any platform-specific data that was stored in it. void registerKernelFactory(const std::string &name, KernelFactory *factory)Â¶ Register a KernelFactory which should be used to create Kernels with a particular name. The Platform takes over ownership of the factory, and will delete it when the Platform itself is deleted. Parameters name â the kernel name for which the factory should be used factory â the factory to use for creating Kernels with the specified name bool supportsKernels(const std::vector<std::string> &kernelNames) constÂ¶ Determine whether this Platforms provides implementations of a set of kernels. Parameters kernelNames â the names of the kernels of interests Returns true if this Platform provides implementations of all the kernels in the list, false if there are any which it does not support Kernel createKernel(const std::string &name, ContextImpl &context) constÂ¶ Create a Kernel object. If you call this method multiple times for different contexts with the same name, the returned Kernels are independent and do not interact with each other. This means that it is possible to have multiple simulations in progress at one time without them interfering. If no KernelFactory has been registered for the specified name, this will throw an exception. Parameters name â the name of the Kernel to get context â the context for which to create a Kernel Returns a newly created Kernel object Public Static Functions static void registerPlatform(Platform *platform)Â¶ Register a new Platform. static int getNumPlatforms()Â¶ Get the number of Platforms that have been registered. static Platform &getPlatform(int index)Â¶ Get a registered Platform by index. static std::vector<std::string> getPluginLoadFailures()Â¶ Get any failures caused during the last call to loadPluginsFromDirectory static Platform &getPlatformByName(const std::string &name)Â¶ Get the registered Platform with a particular name. If no Platform with that name has been registered, this throws an exception. static Platform &findPlatform(const std::vector<std::string> &kernelNames)Â¶ Find a Platform which can be used to perform a calculation. Parameters kernelNames â the names of all kernels which will be needed for the calculation Returns the fastest registered Platform which supports all of the requested kernels. If no Platform exists which supports all of them, this will throw an exception. static void loadPluginLibrary(const std::string &file)Â¶ Load a dynamic library (DLL) which contains an OpenMM plugin. Typically, each Platform is distributed as a separate dynamic library. This method can then be called at runtime to load each available library. Each library should contain an initializer function to register any Platforms and KernelFactories that it contains. If the file does not exist or cannot be loaded, an exception is thrown. Parameters file â the path to the dynamic library file. This is interpreted using the operating systemâs rules for loading libraries. Typically it may be either an absolute path or relative to a set of standard locations. static std::vector<std::string> loadPluginsFromDirectory(const std::string &directory)Â¶ Load multiple dynamic libraries (DLLs) which contain OpenMM plugins from one or more directories. Multiple fully-qualified paths can be joined together with â:â on unix-like systems (or â;â on windows-like systems); each will be searched for plugins, in-order. For example, â/foo/plugins:/bar/pluginsâ will search both /foo/plugins and /bar/plugins. If an identically-named plugin is encountered twice it will be loaded at both points; be careful!!! This method loops over every file contained in the specified directories and calls loadPluginLibrary() for each one. If an error occurs while trying to load a particular file, that file is simply ignored. You can retrieve a list of all such errors by calling getPluginLoadFailures(). Parameters directory â a â:â (unix) or â;â (windows) deliminated list of paths containing libraries to load Returns the names of all files which were successfully loaded as libraries static const std::string &getDefaultPluginsDirectory()Â¶ Get the default directory from which to load plugins. If the environment variable OPENMM_PLUGIN_DIR is set, this returns its value. Otherwise, it returns a platform specific default location. Returns the path to the default plugin directory static const std::string &getOpenMMVersion()Â¶ Get a string containing the version number of the OpenMM library.