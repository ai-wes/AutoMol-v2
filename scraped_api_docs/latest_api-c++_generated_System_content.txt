SystemÂ¶ class SystemÂ¶ This class represents a molecular system. The definition of a System involves four elements: The set of particles in the system The forces acting on them Pairs of particles whose separation should be constrained to a fixed value For periodic systems, the dimensions of the periodic box The particles and constraints are defined directly by the System object, while forces are defined by objects that extend the Force class. After creating a System, call addParticle() once for each particle, addConstraint() for each constraint, and addForce() for each Force. In addition, particles may be designated as âvirtual sitesâ. These are particles whose positions are computed automatically based on the positions of other particles. To define a virtual site, call setVirtualSite(), passing in a VirtualSite object that defines the rules for computing its position. Public Functions System()Â¶ Create a new System. inline int getNumParticles() constÂ¶ Get the number of particles in this System. inline int addParticle(double mass)Â¶ Add a particle to the System. If the mass is 0, Integrators will ignore the particle and not modify its position or velocity. This is most often used for virtual sites, but can also be used as a way to prevent a particle from moving. Parameters mass â the mass of the particle (in atomic mass units) Returns the index of the particle that was added double getParticleMass(int index) constÂ¶ Get the mass (in atomic mass units) of a particle. If the mass is 0, Integrators will ignore the particle and not modify its position or velocity. This is most often used for virtual sites, but can also be used as a way to prevent a particle from moving. Parameters index â the index of the particle for which to get the mass void setParticleMass(int index, double mass)Â¶ Set the mass (in atomic mass units) of a particle. If the mass is 0, Integrators will ignore the particle and not modify its position or velocity. This is most often used for virtual sites, but can also be used as a way to prevent a particle from moving. Parameters index â the index of the particle for which to set the mass mass â the mass of the particle void setVirtualSite(int index, VirtualSite *virtualSite)Â¶ Set a particle to be a virtual site. The VirtualSite object should have been created on the heap with the ânewâ operator. The System takes over ownership of it, and deletes it when the System itself is deleted. Parameters index â the index of the particle that should be treated as a virtual site virtualSite â a pointer to the VirtualSite object describing it inline bool isVirtualSite(int index) constÂ¶ Get whether a particle is a VirtualSite. Parameters index â the index of the particle to check const VirtualSite &getVirtualSite(int index) constÂ¶ Get VirtualSite object for a particle. If the particle is not a virtual site, this throws an exception. Parameters index â the index of the particle to get inline int getNumConstraints() constÂ¶ Get the number of distance constraints in this System. int addConstraint(int particle1, int particle2, double distance)Â¶ Add a constraint to the System. Particles whose mass is 0 cannot participate in constraints. Parameters particle1 â the index of the first particle involved in the constraint particle2 â the index of the second particle involved in the constraint distance â the required distance between the two particles, measured in nm Returns the index of the constraint that was added void getConstraintParameters(int index, int &particle1, int &particle2, double &distance) constÂ¶ Get the parameters defining a distance constraint. Parameters index â the index of the constraint for which to get parameters particle1 â [out] the index of the first particle involved in the constraint particle2 â [out] the index of the second particle involved in the constraint distance â [out] the required distance between the two particles, measured in nm void setConstraintParameters(int index, int particle1, int particle2, double distance)Â¶ Set the parameters defining a distance constraint. Particles whose mass is 0 cannot participate in constraints. Parameters index â the index of the constraint for which to set parameters particle1 â the index of the first particle involved in the constraint particle2 â the index of the second particle involved in the constraint distance â the required distance between the two particles, measured in nm void removeConstraint(int index)Â¶ Remove a constraint from the System. Parameters index â the index of the constraint to remove inline int addForce(Force *force)Â¶ Add a Force to the System. The Force should have been created on the heap with the ânewâ operator. The System takes over ownership of it, and deletes the Force when the System itself is deleted. Parameters force â a pointer to the Force object to be added Returns the index within the System of the Force that was added inline int getNumForces() constÂ¶ Get the number of Force objects that have been added to the System. const Force &getForce(int index) constÂ¶ Get a const reference to one of the Forces in this System. Parameters index â the index of the Force to get Force &getForce(int index)Â¶ Get a writable reference to one of the Forces in this System. Parameters index â the index of the Force to get void removeForce(int index)Â¶ Remove a Force from the System. The memory associated with the removed Force object is deleted. Parameters index â the index of the Force to remove void getDefaultPeriodicBoxVectors(Vec3 &a, Vec3 &b, Vec3 &c) constÂ¶ Get the default values of the vectors defining the axes of the periodic box (measured in nm). Any newly created Context will have its box vectors set to these. They will affect any Force added to the System that uses periodic boundary conditions. Parameters a â [out] the vector defining the first edge of the periodic box b â [out] the vector defining the second edge of the periodic box c â [out] the vector defining the third edge of the periodic box void setDefaultPeriodicBoxVectors(const Vec3 &a, const Vec3 &b, const Vec3 &c)Â¶ Set the default values of the vectors defining the axes of the periodic box (measured in nm). Any newly created Context will have its box vectors set to these. They will affect any Force added to the System that uses periodic boundary conditions. Triclinic boxes are supported, but the vectors must satisfy certain requirements. In particular, a must point in the x direction, b must point âmostlyâ in the y direction, and c must point âmostlyâ in the z direction. See the documentation for details. Parameters a â the vector defining the first edge of the periodic box b â the vector defining the second edge of the periodic box c â the vector defining the third edge of the periodic box bool usesPeriodicBoundaryConditions() constÂ¶ Returns whether or not any forces in this System use periodic boundaries. If a force in this System does not implement usesPeriodicBoundaryConditions a OpenMM::OpenMMException is thrown Returns true if at least one force uses PBC and false otherwise