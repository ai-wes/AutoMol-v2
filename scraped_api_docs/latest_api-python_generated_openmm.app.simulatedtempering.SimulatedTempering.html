<div class="body" role="main">
<section id="simulatedtempering">
<h1>SimulatedTempering<a class="headerlink" href="#simulatedtempering" title="Permalink to this headline">Â¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="openmm.app.simulatedtempering.SimulatedTempering">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">openmm.app.simulatedtempering.</span></span><span class="sig-name descname"><span class="pre">SimulatedTempering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">simulation</span></em>, <em class="sig-param"><span class="pre">temperatures=None</span></em>, <em class="sig-param"><span class="pre">numTemperatures=None</span></em>, <em class="sig-param"><span class="pre">minTemperature=None</span></em>, <em class="sig-param"><span class="pre">maxTemperature=None</span></em>, <em class="sig-param"><span class="pre">weights=None</span></em>, <em class="sig-param"><span class="pre">tempChangeInterval=25</span></em>, <em class="sig-param"><span class="pre">reportInterval=1000</span></em>, <em class="sig-param"><span class="pre">reportFile=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='UTF-8'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.simulatedtempering.SimulatedTempering" title="Permalink to this definition">Â¶</a></dt>
<dd><p>SimulatedTempering implements the simulated tempering algorithm for accelerated sampling.</p>
<p>It runs a simulation while allowing the temperature to vary.  At high temperatures, it can more easily cross
energy barriers to explore a wider area of conformation space.  At low temperatures, it can thoroughly
explore each local region.  For details, see Marinari, E. and Parisi, G., Europhys. Lett. 19(6). pp. 451-458 (1992).</p>
<p>The set of temperatures to sample can be specified in two ways.  First, you can explicitly provide a list
of temperatures by using the âtemperaturesâ argument.  Alternatively, you can specify the minimum and
maximum temperatures, and the total number of temperatures to use.  The temperatures are chosen spaced
exponentially between the two extremes.  For example,</p>
<p>st = SimulatedTempering(simulation, numTemperatures=15, minTemperature=300*kelvin, maxTemperature=450*kelvin)</p>
<p>After creating the SimulatedTempering object, call step() on it to run the simulation.</p>
<p>Transitions between temperatures are performed at regular intervals, as specified by the âtempChangeIntervalâ
argument.  For each transition, a new temperature is selected using the independence sampling method, as
described in Chodera, J. and Shirts, M., J. Chem. Phys. 135, 194110 (2011).</p>
<p>Simulated tempering requires a âweight factorâ for each temperature.  Ideally, these should be chosen so
the simulation spends equal time at every temperature.  You can specify the list of weights to use with the
optional âweightsâ argument.  If this is omitted, weights are selected automatically using the Wang-Landau
algorithm as described in Wang, F. and Landau, D. P., Phys. Rev. Lett. 86(10), pp. 2050-2053 (2001).</p>
<p>To properly analyze the results of the simulation, it is important to know the temperature and weight factors
at every point in time.  The SimulatedTempering object functions as a reporter, writing this information
to a file or stdout at regular intervals (which should match the interval at which you save frames from the
simulation).  You can specify the output file and reporting interval with the âreportFileâ and âreportIntervalâ
arguments.</p>
<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.simulatedtempering.SimulatedTempering.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">simulation</span></em>, <em class="sig-param"><span class="pre">temperatures=None</span></em>, <em class="sig-param"><span class="pre">numTemperatures=None</span></em>, <em class="sig-param"><span class="pre">minTemperature=None</span></em>, <em class="sig-param"><span class="pre">maxTemperature=None</span></em>, <em class="sig-param"><span class="pre">weights=None</span></em>, <em class="sig-param"><span class="pre">tempChangeInterval=25</span></em>, <em class="sig-param"><span class="pre">reportInterval=1000</span></em>, <em class="sig-param"><span class="pre">reportFile=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='UTF-8'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.simulatedtempering.SimulatedTempering.__init__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Create a new SimulatedTempering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation</strong> (<a class="reference internal" href="openmm.app.simulation.Simulation.html#openmm.app.simulation.Simulation" title="openmm.app.simulation.Simulation"><em>Simulation</em></a>) â The Simulation defining the System, Context, and Integrator to use</p></li>
<li><p><strong>temperatures</strong> (<em>list</em>) â The list of temperatures to use for tempering, in increasing order</p></li>
<li><p><strong>numTemperatures</strong> (<em>int</em>) â The number of temperatures to use for tempering.  If temperatures is not None, this is ignored.</p></li>
<li><p><strong>minTemperature</strong> (<em>temperature</em>) â The minimum temperature to use for tempering.  If temperatures is not None, this is ignored.</p></li>
<li><p><strong>maxTemperature</strong> (<em>temperature</em>) â The maximum temperature to use for tempering.  If temperatures is not None, this is ignored.</p></li>
<li><p><strong>weights</strong> (<em>list</em>) â The weight factor for each temperature.  If none, weights are selected automatically.</p></li>
<li><p><strong>tempChangeInterval</strong> (<em>int</em>) â The interval (in time steps) at which to attempt transitions between temperatures</p></li>
<li><p><strong>reportInterval</strong> (<em>int</em>) â The interval (in time steps) at which to write information to the report file</p></li>
<li><p><strong>reportFile</strong> (<em>string</em><em> or </em><em>file</em>) â The file to write reporting information to, specified as a file name or file object</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openmm.app.simulatedtempering.SimulatedTempering.__init__" title="openmm.app.simulatedtempering.SimulatedTempering.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(simulation[,Â temperatures,Â â¦])</p></td>
<td><p>Create a new SimulatedTempering.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openmm.app.simulatedtempering.SimulatedTempering.step" title="openmm.app.simulatedtempering.SimulatedTempering.step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">step</span></code></a>(steps)</p></td>
<td><p>Advance the simulation by integrating a specified number of time steps.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="openmm.app.simulatedtempering.SimulatedTempering.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openmm.app.simulatedtempering.SimulatedTempering.step" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Advance the simulation by integrating a specified number of time steps.</p>
</dd></dl>
</dd></dl>
</section>
</div>