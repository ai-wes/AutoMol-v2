LocalCoordinatesSiteÂ¶ class openmm.openmm.LocalCoordinatesSite(*args)Â¶ This is a VirtualSite that uses the locations of several other particles to compute a local coordinate system, then places the virtual site at a fixed location in that coordinate system. The origin of the coordinate system and the directions of its x and y axes are each specified as a weighted sum of the locations of the other particles: origin = w<sub>1</sub>r<sub>1</sub> + w<sub>2</sub>r<sub>2</sub> + w<sub>3</sub>r<sub>3</sub> + â¦ xdir = w<sub>1</sub>r<sub>1</sub> + w<sub>2</sub>r<sub>2</sub> + w<sub>3</sub>r<sub>3</sub> + â¦ ydir = w<sub>1</sub>r<sub>1</sub> + w<sub>2</sub>r<sub>2</sub> + w<sub>3</sub>r<sub>3</sub> + â¦ For the origin, the weights must add to one. For example if (w<sub>1</sub>, w<sub>2</sub>, w<sub>3</sub>) = (1.0, 0.0, 0.0), the origin of the local coordinate system is at the location of particle 1. For xdir and ydir, the weights must add to zero. For example, if (w<sub>1</sub>, w<sub>2</sub>, w<sub>3</sub>) = (-1.0, 0.5, 0.5), the x axis points from particle 1 toward the midpoint between particles 2 and 3. The z direction is computed as zdir = xdir x ydir. To ensure the axes are all orthogonal, ydir is then recomputed as ydir = zdir x xdir. All three axis vectors are then normalized, and the virtual site location is set to origin + x*xdir + y*ydir + z*zdir __init__(self, particles, originWeights, xWeights, yWeights, localPosition) → LocalCoordinatesSiteÂ¶ __init__(self, particle1, particle2, particle3, originWeights, xWeights, yWeights, localPosition) → LocalCoordinatesSite __init__(self, other) → LocalCoordinatesSite Create a new LocalCoordinatesSite virtual site. This constructor assumes the site depends on exactly three other particles. Parameters particle1 (int) â the index of the first particle particle2 (int) â the index of the second particle particle3 (int) â the index of the third particle originWeights (Vec3) â the weight factors for the three particles when computing the origin location xWeights (Vec3) â the weight factors for the three particles when computing xdir yWeights (Vec3) â the weight factors for the three particles when computing ydir localPosition (Vec3) â the position of the virtual site in the local coordinate system Methods __init__(â¦) Create a new LocalCoordinatesSite virtual site. getLocalPosition(self) Get the position of the virtual site in the local coordinate system. getNumParticles(self) Get the number of particles this virtual site depends on. getOriginWeights(self) Get the weight factors for the particles when computing the origin location. getParticle(self,Â particle) Get the index of a particle this virtual site depends on. getXWeights(self) Get the weight factors for the particles when computing xdir. getYWeights(self) Get the weight factors for the particles when computing ydir. Attributes thisown The membership flag property thisownÂ¶ The membership flag getOriginWeights(self)Â¶ Get the weight factors for the particles when computing the origin location. getXWeights(self)Â¶ Get the weight factors for the particles when computing xdir. getYWeights(self)Â¶ Get the weight factors for the particles when computing ydir. getLocalPosition(self) → Vec3 const &Â¶ Get the position of the virtual site in the local coordinate system. getNumParticles(self) → intÂ¶ Get the number of particles this virtual site depends on. getParticle(self, particle) → intÂ¶ Get the index of a particle this virtual site depends on. Parameters particle (int) â the particle to get (between 0 and getNumParticles()) Returns the index of the particle in the System Return type int